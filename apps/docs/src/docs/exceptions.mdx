---
name: Exceptions and Handlers
menu: Docs
route: /exceptions
---

# Exceptions and Handlers

## Exceptions

Custom Exceptions can be created by extending the HttpException class from `core` package. The `HttpException` takes following properties,

-   statusCode: The HTTP status code of the exception
-   message: The message of the exception
-   name: The name of the exception
-   isOperational: The isOperational flag determines whether the error is operational and if the error message can be forwarded to the end user.

### Creating a custom exception

```javascript
class UnauthorizedException extends HttpException {
    constructor(message = 'You are not authorized') {
        super(
            401,
            message,
            'Unauthorized',
            true // isOperational
        );
    }
}
```

The given example creates an Unauthorized exception. The isOperational flag is set to true, meaning, the error message 'You are not authorized' will be passed along to the response. For errors with isOperational flag set to false, a default error message of 'Something went wrong' could be passed or an error HTML page could be rendered.

## Exception Handlers

Exception Handlers can be created by extending the `ExceptionHandler` abstract class from `core` package. The ExceptionHandler abstract class requires a handle method to be implemented. Exception handlers are registered during the server startup process.

### Creating an exception handler

```javascript

class UnauthorizedExceptionHandler extends ExceptionHandler {
    public handle(
        error: HttpException,
        req: Request,
        res: Response,
        next: NextFunction
    ): void {
        if (error.statusCode !== 401) {
            return next(error); // Pass the error to the next error handler
        }
        req.flash('error', error.message);
        return res.redirect('/auth/login');
    }
}

```

### Regitering the handler

```javascript
server.startup(Number(ServerConfig.PORT), {
    name: 'CMS Server',
    // ... other configurations
    exceptionHandlers: [
        new UnauthorizedExceptionHandler(),
        new UnprocessableEntityExceptionHandler(),
        new GlobalExceptionHandler(), // GlobalExceptionHandler should be kept at the end of the list;
    ],
});
```

In above example, three exception handlers have been registered. Note how `new GlobalExceptionHandler()` is kept at the end of the list. Since errors are passed from one handler to the next, if none of the handlers contain the logic to handle the current exception, it is handled by the `GlobalExceptionHandler`.
